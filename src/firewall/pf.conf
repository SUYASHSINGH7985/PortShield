# PortShield PF Configuration for macOS
# This file defines firewall rules for PortShield
# Load with: sudo pfctl -f /path/to/pf.conf

# Define table for blocked IPs (dynamically managed by PortShield)
table <blocked_ips> persist file "/path/to/blocklist.txt"

# Set default policy: block inbound, pass outbound
set block-policy drop
set loginterface en0

# Rules
# Block all traffic from blocked IPs
block in on en0 from <blocked_ips> to any
block out on en0 from any to <blocked_ips>

# Allow loopback traffic
pass in quick on lo0 all
pass out quick on lo0 all

# Allow established and related connections
pass in on en0 proto tcp from any to any established
pass in on en0 proto udp from any to any established keep state

# Allow SSH (port 22) - IMPORTANT: Don't block yourself!
pass in on en0 proto tcp from any to any port 22 keep state

# Allow HTTP and HTTPS for dashboard
pass in on en0 proto tcp from any to any port 80 keep state
pass in on en0 proto tcp from any to any port 443 keep state

# Allow DNS
pass in on en0 proto udp from any to any port 53 keep state
pass in on en0 proto tcp from any to any port 53 keep state

# Default deny all other inbound traffic
block in on en0 all

# Allow all outbound traffic (adjust as needed)
pass out on en0 all keep state
